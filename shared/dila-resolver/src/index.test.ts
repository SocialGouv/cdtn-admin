import DilaApiClient from "@socialgouv/dila-api-client";
import { extractArticleId, createGetArticleReference } from ".";

test("extractArticleId with legi ref", () => {
  const ref = "LEGIARTI000042683537";
  const urlWithRef = `https://www.legifrance.gouv.fr/codes/article_lc/${ref}/`;
  expect(extractArticleId(urlWithRef).toString()).toEqual([ref].toString());
});

test("extractArticleId with kali ref", () => {
  const ref = "KALIARTI000005849401";
  const urlWithRef = `https://legifrance.gouv.fr/conv_coll/id/${ref}/?idConteneur=KALICONT000005635624`;
  expect(extractArticleId(urlWithRef).toString()).toEqual([ref].toString());
});

test("extractArticleId with jor ref", () => {
  const ref = "JORFARTI000043567208";
  const urlWithRef = `https://www.legifrance.gouv.fr/jorf/article_jo/${ref}/`;
  expect(extractArticleId(urlWithRef)).toEqual([]);
});

test("extractArticleId with no ref", () => {
  const urlWithNoRef = `ttps://www.service-public.fr/particuliers/vosdroits/F13965`;
  expect(extractArticleId(urlWithNoRef)).toEqual([]);
});

test("createGetArticleVersion should return a legi article reference", async () => {
  const dilaApiClientMock = {
    fetch: () => Promise.resolve(getLegiArticlePayload),
  } as unknown as DilaApiClient;

  const getArticleReference = createGetArticleReference(dilaApiClientMock);

  const versions = await getArticleReference("LEGIARTI000033024743");
  expect(versions).toEqual({
    dila_id: "LEGIARTI000042683537",
    dila_cid: "LEGIARTI000006901086",
    dila_container_id: "LEGITEXT000006072050",
    title: "Article L1233-71",
    url: "",
  });
});

test("createGetArticleVersion should return a kali article reference", async () => {
  const dilaApiClientMock = {
    fetch: () => Promise.resolve(getKaliArticlePayload),
  } as unknown as DilaApiClient;

  const getArticleReference = createGetArticleReference(dilaApiClientMock);

  const versions = await getArticleReference("LEGIARTI000033024743");
  expect(versions).toEqual({
    dila_id: "KALIARTI000005846034",
    dila_cid: "KALIARTI000005846033",
    dila_container_id: "KALICONT000005635613",
    title: "Article 18",
    url: "",
  });
});

const getLegiArticlePayload = {
  executionTime: 0,
  dereferenced: false,
  article: {
    id: "LEGIARTI000033024743",
    idTexte: null,
    type: "AUTONOME",
    texte:
      "Dans les entreprises ou les établissements d'au moins mille salariés, ainsi que dans les entreprises mentionnées à l'article L. 2331-1 et celles répondant aux conditions mentionnées aux articles L. 2341-1 et L. 2341-2 , dès lors qu'elles emploient au total au moins mille salariés, l'employeur propose à chaque salarié dont il envisage de prononcer le licenciement pour motif économique un congé de reclassement qui a pour objet de permettre au salarié de bénéficier d'actions de formation et des prestations d'une cellule d'accompagnement des démarches de recherche d'emploi. La durée du congé de reclassement ne peut excéder douze mois. Ce congé débute, si nécessaire, par un bilan de compétences qui a vocation à permettre au salarié de définir un projet professionnel et, le cas échéant, de déterminer les actions de formation nécessaires à son reclassement. Celles-ci sont mises en oeuvre pendant la période prévue au premier alinéa. L'employeur finance l'ensemble de ces actions.",
    texteHtml:
      "<p>Dans les entreprises ou les établissements d'au moins mille salariés, ainsi que dans les entreprises mentionnées à <a href='/affichCodeArticle.do?cidTexte=LEGITEXT000006072050&idArticle=LEGIARTI000006902131&dateTexte=&categorieLien=cid'>l'article L. 2331-1 </a>et celles répondant aux conditions mentionnées aux articles <a href='/affichCodeArticle.do?cidTexte=LEGITEXT000006072050&idArticle=LEGIARTI000006902151&dateTexte=&categorieLien=cid' title='Code du travail - art. L2341-1 (V)'>L. 2341-1 et L. 2341-2</a>, dès lors qu'elles emploient au total au moins mille salariés, l'employeur propose à chaque salarié dont il envisage de prononcer le licenciement pour motif économique un congé de reclassement qui a pour objet de permettre au salarié de bénéficier d'actions de formation et des prestations d'une cellule d'accompagnement des démarches de recherche d'emploi. </p><p>La durée du congé de reclassement ne peut excéder douze mois. </p><p>Ce congé débute, si nécessaire, par un bilan de compétences qui a vocation à permettre au salarié de définir un projet professionnel et, le cas échéant, de déterminer les actions de formation nécessaires à son reclassement. Celles-ci sont mises en oeuvre pendant la période prévue au premier alinéa. </p><p>L'employeur finance l'ensemble de ces actions.</p>",
    num: "L1233-71",
    origine: "LEGI",
    nature: "Article",
    versionArticle: "4.0",
    etat: "MODIFIE",
    dateDebut: 1470787200000,
    dateFin: 1608076800000,
    dateDebutExtension: 32472144000000,
    dateFinExtension: 32472144000000,
    inap: null,
    ordre: 42949,
    context: {
      titresTM: [
        {
          debut: "2008-05-01",
          fin: "2999-01-01",
          titre: "Partie législative  ",
          xPath: "/ARTICLE/CONTEXTE/TEXTE/TM/TITRE_TM",
          cid: "LEGISCTA000006112874",
          id: "LEGISCTA000006112874",
          etat: "VIGUEUR",
        },
        {
          debut: "2008-05-01",
          fin: "2999-01-01",
          titre: "Première partie : Les relations individuelles de travail",
          xPath: "/ARTICLE/CONTEXTE/TEXTE/TM/TM/TITRE_TM",
          cid: "LEGISCTA000006132321",
          id: "LEGISCTA000006132321",
          etat: "VIGUEUR",
        },
        {
          debut: "2008-05-01",
          fin: "2999-01-01",
          titre: "Livre II : Le contrat de travail",
          xPath: "/ARTICLE/CONTEXTE/TEXTE/TM/TM/TM/TITRE_TM",
          cid: "LEGISCTA000006145393",
          id: "LEGISCTA000006145393",
          etat: "VIGUEUR",
        },
        {
          debut: "2008-05-01",
          fin: "2999-01-01",
          titre:
            "Titre III : Rupture du contrat de travail à durée indéterminée",
          xPath: "/ARTICLE/CONTEXTE/TEXTE/TM/TM/TM/TM/TITRE_TM",
          cid: "LEGISCTA000006160710",
          id: "LEGISCTA000006160710",
          etat: "VIGUEUR",
        },
        {
          debut: "2008-05-01",
          fin: "2999-01-01",
          titre: "Chapitre III : Licenciement pour motif économique",
          xPath: "/ARTICLE/CONTEXTE/TEXTE/TM/TM/TM/TM/TM/TITRE_TM",
          cid: "LEGISCTA000006177859",
          id: "LEGISCTA000006177859",
          etat: "VIGUEUR",
        },
        {
          debut: "2008-05-01",
          fin: "2999-01-01",
          titre:
            "Section 6 : Accompagnement social et territorial des procédures de licenciement",
          xPath: "/ARTICLE/CONTEXTE/TEXTE/TM/TM/TM/TM/TM/TM/TITRE_TM",
          cid: "LEGISCTA000006189441",
          id: "LEGISCTA000006189441",
          etat: "VIGUEUR",
        },
        {
          debut: "2008-05-01",
          fin: "2999-01-01",
          titre: "Sous-section 3 : Congé de reclassement.",
          xPath: "/ARTICLE/CONTEXTE/TEXTE/TM/TM/TM/TM/TM/TM/TM/TITRE_TM",
          cid: "LEGISCTA000006195619",
          id: "LEGISCTA000006195619",
          etat: "VIGUEUR",
        },
      ],
      nombreVersionParent: 1,
      longeurChemin: 53,
      titreTxt: [
        {
          debut: "1973-01-03",
          fin: "2999-01-01",
          titre: "Code du travail",
          xPath: "/ARTICLE/CONTEXTE/TEXTE/TITRE_TXT",
          cid: "LEGITEXT000006072050",
          id: "LEGITEXT000006072050",
          etat: "VIGUEUR",
        },
      ],
    },
    cid: "LEGIARTI000006901086",
    cidTexte: null,
    sectionParentCid: "LEGISCTA000006195619",
    sectionParentId: "LEGISCTA000006195619",
    sectionParentTitre: "Sous-section 3 : Congé de reclassement.",
    fullSectionsTitre:
      "Partie législative   &gt; Première partie : Les relations individuelles de travail &gt; Livre II : Le contrat de travail &gt; Titre III : Rupture du contrat de travail à durée indéterminée &gt; Chapitre III : Licenciement pour motif économique &gt; Section 6 : Accompagnement social et territorial des procédures de licenciement &gt; Sous-section 3 : Congé de reclassement.",
    refInjection: "MD-20210820_204513_335_BDJQUOT",
    idTechInjection: "index_DATA_ARTICLE_LEGIARTI000033024743",
    idEli: null,
    idEliAlias: null,
    calipsos: [],
    textTitles: [
      {
        id: "LEGITEXT000006072050",
        titre: "Code du travail",
        titreLong: "Code du travail",
        etat: "VIGUEUR",
        dateDebut: 94867200000,
        dateFin: 32472144000000,
        cid: "LEGITEXT000006072050",
        datePubli: 32472144000000,
        datePubliComputed: null,
        dateTexte: 32472144000000,
        dateTexteComputed: null,
        nature: "CODE",
        nor: "",
        num: "",
        numParution: "",
        originePubli: "",
        appliGeo: null,
        codesNomenclatures: [],
        visas: null,
        nota: null,
        notice: null,
        travauxPreparatoires: null,
        signataires: null,
        dossiersLegislatifs: [],
        ancienId: null,
      },
    ],
    nota: "",
    notaHtml: "<p></p><p></p><p></p><p><br clear='none'/></p>",
    activitePro: [],
    numeroBrochure: [],
    numeroBo: null,
    conteneurs: [],
    lienModifications: [
      {
        textCid: "JORFTEXT000000465978",
        textTitle: "Ordonnance n°2007-329 du 12 mars 2007",
        linkType: "CODIFICATION",
        linkOrientation: "source",
        articleNum: "",
        articleId: "JORFTEXT000000465978",
        natureText: "ORDONNANCE",
        datePubliTexte: "2007-03-13",
        dateSignaTexte: "2007-03-12",
        dateDebutCible: "2999-01-01",
      },
      {
        textCid: "JORFTEXT000032983213",
        textTitle: "LOI n°2016-1088 du 8 août 2016 - art. 96",
        linkType: "MODIFIE",
        linkOrientation: "cible",
        articleNum: "96",
        articleId: "LEGIARTI000033001182",
        natureText: "LOI",
        datePubliTexte: "2016-08-09",
        dateSignaTexte: "2016-08-08",
        dateDebutCible: "2016-08-10",
      },
    ],
    lienCitations: [
      {
        textCid: "KALITEXT000019987311",
        textTitle: "à l'accord du 8 décembre 1961  - art. (VNE)",
        linkType: "CITATION",
        linkOrientation: "cible",
        articleNum: "",
        articleId: "KALIARTI000019987313",
        natureText: "Avenant",
        date: 1629556984357,
        parentCid: null,
        numTexte: "",
        datePubli: 1230076800000,
        dateDebut: 1222732800000,
      },
      {
        textCid: "KALITEXT000020022495",
        textTitle:
          "portant modifications des délibérations D 25 et... - art. (VNE)",
        linkType: "CITATION",
        linkOrientation: "cible",
        articleNum: "",
        articleId: "KALIARTI000020022497",
        natureText: "Avenant",
        date: 1629556984357,
        parentCid: null,
        numTexte: "",
        datePubli: 1230768000000,
        dateDebut: 1222732800000,
      },
      {
        textCid: "JORFTEXT000020466868",
        textTitle: "Arrêté du 30 mars 2009 - art., v. init.",
        linkType: "CITATION",
        linkOrientation: "cible",
        articleNum: "",
        articleId: "JORFARTI000020466875",
        natureText: "ARRETE",
        date: 1629556984357,
        parentCid: null,
        numTexte: "",
        datePubli: 1238544000000,
        dateDebut: 32472144000000,
      },
      {
        textCid: "KALITEXT000022425458",
        textTitle: "relatif au développement de la GPEC - art. (VNE)",
        linkType: "CITATION",
        linkOrientation: "cible",
        articleNum: "",
        articleId: "KALIARTI000022425473",
        natureText: "Accord",
        date: 1629556984357,
        parentCid: null,
        numTexte: "",
        datePubli: 1278288000000,
        dateDebut: 1264723200000,
      },
      {
        textCid: "JORFTEXT000024691298",
        textTitle: "Arrêté du 6 octobre 2011 - art. (V)",
        linkType: "CITATION",
        linkOrientation: "cible",
        articleNum: "",
        articleId: "LEGIARTI000024694824",
        natureText: "ARRETE",
        date: 1629556984358,
        parentCid: null,
        numTexte: "",
        datePubli: 1319155200000,
        dateDebut: 1319241600000,
      },
      {
        textCid: "JORFTEXT000024691298",
        textTitle: "Arrêté du 6 octobre 2011 - art., v. init.",
        linkType: "CITATION",
        linkOrientation: "cible",
        articleNum: "",
        articleId: "JORFARTI000024691307",
        natureText: "ARRETE",
        date: 1629556984358,
        parentCid: null,
        numTexte: "",
        datePubli: 1319155200000,
        dateDebut: 32472144000000,
      },
      {
        textCid: "KALITEXT000027547784",
        textTitle: "Mise à jour de la convention - art. 15 (VE)",
        linkType: "CITATION",
        linkOrientation: "cible",
        articleNum: "15",
        articleId: "KALIARTI000027547844",
        natureText: "Avenant",
        date: 1629556984358,
        parentCid: null,
        numTexte: "2",
        datePubli: 1371427200000,
        dateDebut: 1354492800000,
      },
      {
        textCid: "JORFTEXT000028811249",
        textTitle: "Observations du  - art., v. init.",
        linkType: "CITATION",
        linkOrientation: "cible",
        articleNum: "",
        articleId: "JORFARTI000028811250",
        natureText: "OBSERVATION",
        date: 1629556984358,
        parentCid: null,
        numTexte: "",
        datePubli: 1396310400000,
        dateDebut: 32472144000000,
      },
      {
        textCid: "JORFTEXT000030513552",
        textTitle: "ARRÊTÉ du 16 avril 2015 - art. (V)",
        linkType: "CITATION",
        linkOrientation: "cible",
        articleNum: "1",
        articleId: "LEGIARTI000030515068",
        natureText: "ARRETE",
        date: 1629556984358,
        parentCid: null,
        numTexte: "",
        datePubli: 1429747200000,
        dateDebut: 1429833600000,
      },
      {
        textCid: "KALITEXT000031490691",
        textTitle: "Régime de prévoyance des salariés - art. 13 (VE)",
        linkType: "CITATION",
        linkOrientation: "cible",
        articleNum: "13",
        articleId: "KALIARTI000042421849",
        natureText: "Accord",
        date: 1629556984358,
        parentCid: null,
        numTexte: "",
        datePubli: 1447804800000,
        dateDebut: 1594252800000,
      },
      {
        textCid: "JORFTEXT000031890044",
        textTitle: "Arrêté du 8 janvier 2016 - art. 1, v. init.",
        linkType: "CITATION",
        linkOrientation: "cible",
        articleNum: "1",
        articleId: "JORFARTI000031890047",
        natureText: "ARRETE",
        date: 1629556984358,
        parentCid: null,
        numTexte: "",
        datePubli: 1453507200000,
        dateDebut: 32472144000000,
      },
      {
        textCid: "JORFTEXT000036336556",
        textTitle: "Décret n°2017-1820 du 29 décembre 2017 - art. (V)",
        linkType: "CITATION",
        linkOrientation: "cible",
        articleNum: "Annexe VI",
        articleId: "LEGIARTI000036518665",
        natureText: "DECRET",
        date: 1629556984358,
        parentCid: null,
        numTexte: "2017-1820",
        datePubli: 1514592000000,
        dateDebut: 1514678400000,
      },
      {
        textCid: "JORFTEXT000036336556",
        textTitle: "Décret n°2017-1820 du 29 décembre 2017 - art. (V)",
        linkType: "CITATION",
        linkOrientation: "cible",
        articleNum: "Annexe IV",
        articleId: "LEGIARTI000036518682",
        natureText: "DECRET",
        date: 1629556984359,
        parentCid: null,
        numTexte: "2017-1820",
        datePubli: 1514592000000,
        dateDebut: 1514678400000,
      },
      {
        textCid: "JORFTEXT000036336556",
        textTitle: "Décret n°2017-1820 du 29 décembre 2017 - art. (V)",
        linkType: "CITATION",
        linkOrientation: "cible",
        articleNum: "Annexe V",
        articleId: "LEGIARTI000036518690",
        natureText: "DECRET",
        date: 1629556984359,
        parentCid: null,
        numTexte: "2017-1820",
        datePubli: 1514592000000,
        dateDebut: 1514678400000,
      },
      {
        textCid: "KALITEXT000036731682",
        textTitle:
          "relatif au régime AGIRC-ARRCO de retraite compl... - art. 81 (VNE)",
        linkType: "CITATION",
        linkOrientation: "cible",
        articleNum: "81",
        articleId: "KALIARTI000036731841",
        natureText: "Accord",
        date: 1629556984359,
        parentCid: null,
        numTexte: "",
        datePubli: 1521590400000,
        dateDebut: 1510876800000,
      },
      {
        textCid: "KALITEXT000037547514",
        textTitle:
          "relatif à la mise en œuvre du contrat de sécuri... - art. 1er (VNE)",
        linkType: "CITATION",
        linkOrientation: "cible",
        articleNum: "1er",
        articleId: "KALIARTI000037547519",
        natureText: "Accord",
        date: 1629556984359,
        parentCid: null,
        numTexte: "",
        datePubli: 1540944000000,
        dateDebut: 1531785600000,
      },
      {
        textCid: "JORFTEXT000042169408",
        textTitle: "Rapport - art., v. init.",
        linkType: "CITATION",
        linkOrientation: "cible",
        articleNum: "",
        articleId: "JORFARTI000042169409",
        natureText: "RAPPORT",
        date: 1629556984359,
        parentCid: null,
        numTexte: "",
        datePubli: 1596067200000,
        dateDebut: 32472144000000,
      },
      {
        textCid: "JORFTEXT000043268636",
        textTitle: "Décret n°2021-297 du 18 mars 2021 - art. 1 (V)",
        linkType: "CITATION",
        linkOrientation: "cible",
        articleNum: "1",
        articleId: "LEGIARTI000043272872",
        natureText: "DECRET",
        date: 1629556984359,
        parentCid: null,
        numTexte: "2021-297",
        datePubli: 1616198400000,
        dateDebut: 1616284800000,
      },
      {
        textCid: "JORFTEXT000043268636",
        textTitle: "Décret n°2021-297 du 18 mars 2021 - art. 15 (V)",
        linkType: "CITATION",
        linkOrientation: "cible",
        articleNum: "15",
        articleId: "LEGIARTI000043272893",
        natureText: "DECRET",
        date: 1629556984359,
        parentCid: null,
        numTexte: "2021-297",
        datePubli: 1616198400000,
        dateDebut: 1616284800000,
      },
      {
        textCid: "JORFTEXT000043268636",
        textTitle: "Décret n°2021-297 du 18 mars 2021 - art. 3 (V)",
        linkType: "CITATION",
        linkOrientation: "cible",
        articleNum: "3",
        articleId: "LEGIARTI000043272879",
        natureText: "DECRET",
        date: 1629556984359,
        parentCid: null,
        numTexte: "2021-297",
        datePubli: 1616198400000,
        dateDebut: 1616284800000,
      },
      {
        textCid: "JORFTEXT000043268636",
        textTitle: "Décret n°2021-297 du 18 mars 2021 - art. 6 (V)",
        linkType: "CITATION",
        linkOrientation: "cible",
        articleNum: "6",
        articleId: "LEGIARTI000043272882",
        natureText: "DECRET",
        date: 1629556984359,
        parentCid: null,
        numTexte: "2021-297",
        datePubli: 1616198400000,
        dateDebut: 1616284800000,
      },
      {
        textCid: "JORFTEXT000043306112",
        textTitle: "Décret n°2021-346 du 30 mars 2021 - art. 2",
        linkType: "CITATION",
        linkOrientation: "cible",
        articleNum: "2",
        articleId: "LEGIARTI000043307135",
        natureText: "DECRET",
        date: 1629556984360,
        parentCid: null,
        numTexte: "2021-346",
        datePubli: 1617148800000,
        dateDebut: 1617235200000,
      },
      {
        textCid: "JORFTEXT000043623639",
        textTitle: "Décret n°2021-730 du 8 juin 2021 - art. 1",
        linkType: "CITATION",
        linkOrientation: "cible",
        articleNum: "1",
        articleId: "LEGIARTI000043624961",
        natureText: "DECRET",
        date: 1629556984360,
        parentCid: null,
        numTexte: "2021-730",
        datePubli: 1623196800000,
        dateDebut: 1623283200000,
      },
      {
        textCid: "JORFTEXT000043623639",
        textTitle: "Décret n°2021-730 du 8 juin 2021 - art. 2",
        linkType: "CITATION",
        linkOrientation: "cible",
        articleNum: "2",
        articleId: "LEGIARTI000043624963",
        natureText: "DECRET",
        date: 1629556984360,
        parentCid: null,
        numTexte: "2021-730",
        datePubli: 1623196800000,
        dateDebut: 1623283200000,
      },
      {
        textCid: "JORFTEXT000043947155",
        textTitle: "Décret n°2021-1092 du 19 août 2021 (V)",
        linkType: "CITATION",
        linkOrientation: "cible",
        articleNum: "",
        articleId: "LEGITEXT000043947513",
        natureText: "DECRET",
        date: 1629556984360,
        parentCid: null,
        numTexte: "2021-1092",
        datePubli: 1629417600000,
        dateDebut: 1629504000000,
      },
      {
        textCid: "LEGITEXT000006072050",
        textTitle: "Code du travail - art. D1233-38 (V)",
        linkType: "CITATION",
        linkOrientation: "cible",
        articleNum: "D1233-38",
        articleId: "LEGIARTI000036248547",
        natureText: "CODE",
        date: 1629556984360,
        parentCid: null,
        numTexte: "",
        datePubli: 32472144000000,
        dateDebut: 1513987200000,
      },
      {
        textCid: "LEGITEXT000006072050",
        textTitle: "Code du travail - art. L1233-24-3 (VT)",
        linkType: "CITATION",
        linkOrientation: "cible",
        articleNum: "L1233-24-3",
        articleId: "LEGIARTI000036261816",
        natureText: "CODE",
        date: 1629556984360,
        parentCid: null,
        numTexte: "",
        datePubli: 32472144000000,
        dateDebut: 1513900800000,
      },
      {
        textCid: "LEGITEXT000006072050",
        textTitle: "Code du travail - art. L1233-57-3 (VD)",
        linkType: "CITATION",
        linkOrientation: "cible",
        articleNum: "L1233-57-3",
        articleId: "LEGIARTI000036431884",
        natureText: "CODE",
        date: 1629556984360,
        parentCid: null,
        numTexte: "",
        datePubli: 32472144000000,
        dateDebut: 1546300800000,
      },
      {
        textCid: "LEGITEXT000006072050",
        textTitle: "Code du travail - art. L1233-57-9 (VD)",
        linkType: "CITATION",
        linkOrientation: "cible",
        articleNum: "L1233-57-9",
        articleId: "LEGIARTI000035652904",
        natureText: "CODE",
        date: 1629556984360,
        parentCid: null,
        numTexte: "",
        datePubli: 32472144000000,
        dateDebut: 1514764800000,
      },
      {
        textCid: "LEGITEXT000006072050",
        textTitle: "Code du travail - art. L1233-61 (M)",
        linkType: "CITATION",
        linkOrientation: "cible",
        articleNum: "L1233-61",
        articleId: "LEGIARTI000033024736",
        natureText: "CODE",
        date: 1629556984360,
        parentCid: null,
        numTexte: "",
        datePubli: 32472144000000,
        dateDebut: 1470787200000,
      },
      {
        textCid: "LEGITEXT000006072050",
        textTitle: "Code du travail - art. L1233-65 (V)",
        linkType: "CITATION",
        linkOrientation: "cible",
        articleNum: "L1233-65",
        articleId: "LEGIARTI000024422267",
        natureText: "CODE",
        date: 1629556984361,
        parentCid: null,
        numTexte: "",
        datePubli: 32472144000000,
        dateDebut: 1311984000000,
      },
      {
        textCid: "LEGITEXT000006072050",
        textTitle: "Code du travail - art. L1233-66 (V)",
        linkType: "CITATION",
        linkOrientation: "cible",
        articleNum: "L1233-66",
        articleId: "LEGIARTI000031013988",
        natureText: "CODE",
        date: 1629556984361,
        parentCid: null,
        numTexte: "",
        datePubli: 32472144000000,
        dateDebut: 1438992000000,
      },
      {
        textCid: "LEGITEXT000006072050",
        textTitle: "Code du travail - art. L1233-76 (V)",
        linkType: "CITATION",
        linkOrientation: "cible",
        articleNum: "L1233-76",
        articleId: "LEGIARTI000006901091",
        natureText: "CODE",
        date: 1629556984361,
        parentCid: null,
        numTexte: "",
        datePubli: 32472144000000,
        dateDebut: 1209600000000,
      },
      {
        textCid: "LEGITEXT000006072050",
        textTitle: "Code du travail - art. L1233-77 (Ab)",
        linkType: "CITATION",
        linkOrientation: "cible",
        articleNum: "L1233-77",
        articleId: "LEGIARTI000006901092",
        natureText: "CODE",
        date: 1629556984361,
        parentCid: null,
        numTexte: "",
        datePubli: 32472144000000,
        dateDebut: 1209600000000,
      },
      {
        textCid: "LEGITEXT000006072050",
        textTitle: "Code du travail - art. L1233-84 (V)",
        linkType: "CITATION",
        linkOrientation: "cible",
        articleNum: "L1233-84",
        articleId: "LEGIARTI000006901102",
        natureText: "CODE",
        date: 1629556984361,
        parentCid: null,
        numTexte: "",
        datePubli: 32472144000000,
        dateDebut: 1209600000000,
      },
      {
        textCid: "LEGITEXT000006072050",
        textTitle: "Code du travail - art. L1233-90-1 (Ab)",
        linkType: "CITATION",
        linkOrientation: "cible",
        articleNum: "L1233-90-1",
        articleId: "LEGIARTI000027550242",
        natureText: "CODE",
        date: 1629556984361,
        parentCid: null,
        numTexte: "",
        datePubli: 32472144000000,
        dateDebut: 1372636800000,
      },
      {
        textCid: "LEGITEXT000006072050",
        textTitle: "Code du travail - art. L1235-16 (MMN)",
        linkType: "CITATION",
        linkOrientation: "cible",
        articleNum: "L1235-16",
        articleId: "LEGIARTI000018767269",
        natureText: "CODE",
        date: 1629556984361,
        parentCid: null,
        numTexte: "",
        datePubli: 32472144000000,
        dateDebut: 1356998400000,
      },
      {
        textCid: "LEGITEXT000006072050",
        textTitle: "Code du travail - art. L2331-1",
        linkType: "CITATION",
        linkOrientation: "source",
        articleNum: "L2331-1",
        articleId: "LEGIARTI000006902131",
        natureText: "CODE",
        date: 1629556984361,
        parentCid: null,
        numTexte: "",
        datePubli: 32472144000000,
        dateDebut: 1209600000000,
      },
      {
        textCid: "LEGITEXT000006072050",
        textTitle: "Code du travail - art. L2341-1 (V)",
        linkType: "CITATION",
        linkOrientation: "source",
        articleNum: "L2341-1",
        articleId: "LEGIARTI000006902151",
        natureText: "CODE",
        date: 1629556984361,
        parentCid: null,
        numTexte: "",
        datePubli: 32472144000000,
        dateDebut: 1209600000000,
      },
      {
        textCid: "LEGITEXT000006072050",
        textTitle: "Code du travail - art. R1233-27 (V)",
        linkType: "CITATION",
        linkOrientation: "cible",
        articleNum: "R1233-27",
        articleId: "LEGIARTI000038033423",
        natureText: "CODE",
        date: 1629556984362,
        parentCid: null,
        numTexte: "",
        datePubli: 32472144000000,
        dateDebut: 1546300800000,
      },
      {
        textCid: "LEGITEXT000006072050",
        textTitle: "Code du travail - art. R6313-8 (V)",
        linkType: "CITATION",
        linkOrientation: "cible",
        articleNum: "R6313-8",
        articleId: "LEGIARTI000038014115",
        natureText: "CODE",
        date: 1629556984362,
        parentCid: null,
        numTexte: "",
        datePubli: 32472144000000,
        dateDebut: 1546300800000,
      },
      {
        textCid: "KALITEXT000042419797",
        textTitle:
          "Modification de l'accord du 9 juillet 2015 (pré... - art. 2 (VE)",
        linkType: "CITATION",
        linkOrientation: "cible",
        articleNum: "2",
        articleId: "KALIARTI000042419807",
        natureText: "Avenant",
        date: 1629556984362,
        parentCid: null,
        numTexte: "",
        datePubli: 32472144000000,
        dateDebut: 1594252800000,
      },
      {
        textCid: "KALITEXT000037398150",
        textTitle: "Régime de prévoyance - art. 1er (VE)",
        linkType: "CITATION",
        linkOrientation: "cible",
        articleNum: "1er",
        articleId: "KALIARTI000037398154",
        natureText: "Avenant",
        date: 1629556984362,
        parentCid: null,
        numTexte: "",
        datePubli: 32472144000000,
        dateDebut: 1514764800000,
      },
    ],
    lienConcordes: [
      {
        textCid: "LEGITEXT000006072050",
        textTitle: "Code du travail - art. L321-4-3 (AbD)",
        linkType: "CONCORDE",
        linkOrientation: "cible",
        articleNum: "L321-4-3",
        articleId: "LEGIARTI000006648051",
        natureText: "CODE",
      },
      {
        textCid: "LEGITEXT000006072050",
        textTitle: "Code du travail L321-4-3 alinéas 1 et 2",
        linkType: "CONCORDANCE",
        linkOrientation: "source",
        articleNum: "",
        articleId: "LEGITEXT000006072050",
        natureText: "CODE",
      },
    ],
    lienAutres: [],
    articleVersions: [
      {
        id: "LEGIARTI000006901086",
        etat: "MODIFIE",
        version: "1.0",
        dateDebut: 1209600000000,
        dateFin: 1332547200000,
        numero: null,
        ordre: null,
      },
      {
        id: "LEGIARTI000025578961",
        etat: "MODIFIE",
        version: "2.0",
        dateDebut: 1332547200000,
        dateFin: 1371427200000,
        numero: null,
        ordre: null,
      },
      {
        id: "LEGIARTI000027566283",
        etat: "MODIFIE",
        version: "3.0",
        dateDebut: 1371427200000,
        dateFin: 1470787200000,
        numero: null,
        ordre: null,
      },
      {
        id: "LEGIARTI000033024743",
        etat: "MODIFIE",
        version: "4.0",
        dateDebut: 1470787200000,
        dateFin: 1608076800000,
        numero: null,
        ordre: null,
      },
      {
        id: "LEGIARTI000042683537",
        etat: "VIGUEUR",
        version: "5.0",
        dateDebut: 1608076800000,
        dateFin: 32472144000000,
        numero: null,
        ordre: null,
      },
    ],
    computedNums: ["L1233-71", "1233-71"],
    versionPrecedente: "LEGIARTI000027566283",
    conditionDiffere: null,
    historique: null,
    surtitre: null,
    renvoi: null,
  },
};

const getKaliArticlePayload = {
  executionTime: 0,
  dereferenced: false,
  article: {
    id: "KALIARTI000005846034",
    idTexte: null,
    type: null,
    texte:
      "1. Des congés payés sont attribués aux salariés dans les conditions prévues par la législation en vigueur, sous réserve des dispositions plus favorables de la présente convention ou résultant de conventions particulières. 2. En l'absence de dispositions particulières prévues dans les conventions régionales ou d'établissement, la période des vacances est fixée par l'employeur en se référant aux usages et après consultation du comité d'établissement ou, à défaut, des délégués du personnel. Elle doit comprendre dans tous les cas la période du 1er juin au 31 octobre. Cependant lorsque le bénéficiaire d'un congé en exprimera le désir il pourra, après accord avec son employeur, prendre son congé en dehors de la période prévue dans l'entreprise. Des dispositions particulières pourront être prises pour les travaux saisonniers après consultation du comité d'établissement ou, à défaut de comité, des délégués du personnel. 3. Le congé payé ne dépassant pas 18 jours ouvrables doit être continu et pris pendant la période légale (1) (2). 4. En cas de congé par roulement, l'ordre de départ est fixé par l'employeur, compte tenu des nécessités du service. Il sera tenu compte, dans la mesure du possible, des désirs particuliers des intéressés, de leur situation de famille et de leur ancienneté. L'employeur s'efforcera de fixer à la même date les congés des membres d'une même famille vivant sous le même toit et travaillant dans le même établissement. Au personnel dont les enfants fréquentent l'école, les congés seront donnés dans la mesure du possible au cours des vacances scolaires. L'ordre de départ sera porté à la connaissance du personnel par affichage aussitôt que possible et, en tout état de cause, 1 mois au moins avant le départ des intéressés. 5. Lorsqu'un salarié se trouvera, par suite d'une maladie ou d'un accident, dans l'incapacité de prendre son congé à la date fixée, la période des vacances pourra être étendue pour lui jusqu'au 31 décembre. Si cette extension ne lui permettait pas néanmoins de prendre son congé, l'indemnité compensatrice correspondant au nombre de jours de congé calculé en fonction de son temps de travail effectif lui sera alors versée. 6. Dans les cas exceptionnels où un salarié en congé serait rappelé pour les besoins du service, il lui sera accordé un congé supplémentaire d'une durée nette de 2 jours. Les frais de voyage occasionnés par ce déplacement et les frais supplémentaires qui seraient nécessités par ce rappel lui seront remboursés sur justifications. 7. Les salariés n'ayant pas 1 an de présence au 1er juin pourront, sur leur demande, bénéficier d'un complément de congé non payé, jusqu'à concurrence de la durée légale correspondant à 1 an de présence. 8. La durée de congé prévue à la présente convention est proportionnelle à la durée du travail effectif calculée pendant la période de référence suivant les dispositions légales en vigueur. Toutefois, les périodes militaires de réserve obligatoires et non provoquées par l'intéressé, les permissions exceptionnelles de courte durée accordées au cours de l'année, ainsi que les absences pour accouchement, sont considérées, pour le calcul de la durée des congés, comme temps de travail effectif. Un congé payé exceptionnel de 3 jours ouvrables sera accordé à l'occasion de son mariage au salarié ayant au moins 1 année d'ancienneté (3). Un congé payé exceptionnel de 1 jour ouvrable sera également accordé au salarié ayant au moins 1 année d'ancienneté en cas de décès du conjoint, du père, de la mère ou d'un enfant de ce salarié (3). 9. En cas de décès du bénéficiaire, l'indemnité de congé payé acquise au moment du décès sera versée aux ayants droit. 10. Pour faciliter aux salariés nord-africains l'exercice de leur droit aux congés payés, ceux-ci auront la faculté de bénéficier d'un certain nombre de jours supplémentaires représentant la durée nécessaire du voyage d'aller et de retour de leur lieu de travail à leur pays d'origine. Ce temps supplémentaire ne sera pas rémunéré et les intéressés devront fournir toutes pièces justificatives de leur déplacement effectif. Au moment du départ des salariés, il leur sera remis une attestation d'emploi destinée à faciliter leur retour, avec certitude de reprendre leur place, si ce retour a lieu dans les délais convenus. En accord avec leur employeur, les salariés nord-africains pourront, après avis donné à l'inspecteur du travail, bloquer leur congé de 2 années sur la deuxième année. 11. Les dispositions particulières pourront être prévues dans les entreprises afin de faciliter aux salariés étrangers ou originaires des territoires d'outre-mer la prise de leur congé. 12. Congés exceptionnels - Un congé payé exceptionnel de trois jours ouvrables sera accordé à l'occasion de son mariage au salarié ayant au moins un an d'ancienneté. Un congé payé exceptionnel de 3 jours ouvrables sera accordé sans condition d'ancienneté au salarié à l'occasion du décès de son conjoint, de son père, de sa mère ou d'un enfant. Ce congé payé sera de 1 jour à l'occasion du décès du grand-père, de la grand-mère, du beau-père, de la belle-mère, du frère, de la soeur, du beau-frère, de la belle-soeur, du gendre ou de la belle fille (4). (1) Etant donné les caractéristiques spécifiques des entreprises relevant de la chambre syndicale des entrepreneurs de travaux photographiques, cette disposition ne leur est pas applicable et fera l'objet d'accords d'entreprise. (2) Voir aussi accord du 11 octobre 1989, article 6. (3) Alinéas abrogés par avenant du 9 juillet 1964 (non étendu). (4) Paragraphe ajouté avenant du 9 juillet 1964 (non étendu).",
    texteHtml:
      "<p>1. Des congés payés sont attribués aux salariés dans les conditions prévues par la législation en vigueur, sous réserve des dispositions plus favorables de la présente convention ou résultant de conventions particulières.</p><p>2. En l'absence de dispositions particulières prévues dans les conventions régionales ou d'établissement, la période des vacances est fixée par l'employeur en se référant aux usages et après consultation du comité d'établissement ou, à défaut, des délégués du personnel. Elle doit comprendre dans tous les cas la période du 1er juin au 31 octobre.</p><p>Cependant lorsque le bénéficiaire d'un congé en exprimera le désir il pourra, après accord avec son employeur, prendre son congé en dehors de la période prévue dans l'entreprise.</p><p>Des dispositions particulières pourront être prises pour les travaux saisonniers après consultation du comité d'établissement ou, à défaut de comité, des délégués du personnel.</p><p>3. Le congé payé ne dépassant pas 18 jours ouvrables doit être continu et pris pendant la période légale (1) (2).</p><p>4. En cas de congé par roulement, l'ordre de départ est fixé par l'employeur, compte tenu des nécessités du service.</p><p>Il sera tenu compte, dans la mesure du possible, des désirs particuliers des intéressés, de leur situation de famille et de leur ancienneté. L'employeur s'efforcera de fixer à la même date les congés des membres d'une même famille vivant sous le même toit et travaillant dans le même établissement. Au personnel dont les enfants fréquentent l'école, les congés seront donnés dans la mesure du possible au cours des vacances scolaires.</p><p>L'ordre de départ sera porté à la connaissance du personnel par affichage aussitôt que possible et, en tout état de cause, 1 mois au moins avant le départ des intéressés.</p><p>5. Lorsqu'un salarié se trouvera, par suite d'une maladie ou d'un accident, dans l'incapacité de prendre son congé à la date fixée, la période des vacances pourra être étendue pour lui jusqu'au 31 décembre. Si cette extension ne lui permettait pas néanmoins de prendre son congé, l'indemnité compensatrice correspondant au nombre de jours de congé calculé en fonction de son temps de travail effectif lui sera alors versée.</p><p>6. Dans les cas exceptionnels où un salarié en congé serait rappelé pour les besoins du service, il lui sera accordé un congé supplémentaire d'une durée nette de 2 jours. Les frais de voyage occasionnés par ce déplacement et les frais supplémentaires qui seraient nécessités par ce rappel lui seront remboursés sur justifications.</p><p>7. Les salariés n'ayant pas 1 an de présence au 1er juin pourront, sur leur demande, bénéficier d'un complément de congé non payé, jusqu'à concurrence de la durée légale correspondant à 1 an de présence.</p><p>8. La durée de congé prévue à la présente convention est proportionnelle à la durée du travail effectif calculée pendant la période de référence suivant les dispositions légales en vigueur.</p><p>Toutefois, les périodes militaires de réserve obligatoires et non provoquées par l'intéressé, les permissions exceptionnelles de courte durée accordées au cours de l'année, ainsi que les absences pour accouchement, sont considérées, pour le calcul de la durée des congés, comme temps de travail effectif.</p><p>Un congé payé exceptionnel de 3 jours ouvrables sera accordé à l'occasion de son mariage au salarié ayant au moins 1 année d'ancienneté (3).</p><p>Un congé payé exceptionnel de 1 jour ouvrable sera également accordé au salarié ayant au moins 1 année d'ancienneté en cas de décès du conjoint, du père, de la mère ou d'un enfant de ce salarié (3).</p><p>9. En cas de décès du bénéficiaire, l'indemnité de congé payé acquise au moment du décès sera versée aux ayants droit.</p><p>10. Pour faciliter aux salariés nord-africains l'exercice de leur droit aux congés payés, ceux-ci auront la faculté de bénéficier d'un certain nombre de jours supplémentaires représentant la durée nécessaire du voyage d'aller et de retour de leur lieu de travail à leur pays d'origine.</p><p>Ce temps supplémentaire ne sera pas rémunéré et les intéressés devront fournir toutes pièces justificatives de leur déplacement effectif.</p><p>Au moment du départ des salariés, il leur sera remis une attestation d'emploi destinée à faciliter leur retour, avec certitude de reprendre leur place, si ce retour a lieu dans les délais convenus.</p><p>En accord avec leur employeur, les salariés nord-africains pourront, après avis donné à l'inspecteur du travail, bloquer leur congé de 2 années sur la deuxième année.</p><p>11. Les dispositions particulières pourront être prévues dans les entreprises afin de faciliter aux salariés étrangers ou originaires des territoires d'outre-mer la prise de leur congé.</p><p>12. <em>Congés exceptionnels - Un congé payé exceptionnel de trois jours ouvrables sera accordé à l'occasion de son mariage au salarié ayant au moins un an d'ancienneté.</em></p><p><em>Un congé payé exceptionnel de 3 jours ouvrables sera accordé sans condition d'ancienneté au salarié à l'occasion du décès de son conjoint, de son père, de sa mère ou d'un enfant.</em></p><p><em>Ce congé payé sera de 1 jour à l'occasion du décès du grand-père, de la grand-mère, du beau-père, de la belle-mère, du frère, de la soeur, du beau-frère, de la belle-soeur, du gendre ou de la belle fille</em> (4).</p><p><font color='#999999' size='1'><em>(1) Etant donné les caractéristiques spécifiques des entreprises relevant de la chambre syndicale des entrepreneurs de travaux photographiques, cette disposition ne leur est pas applicable et fera l'objet d'accords d'entreprise. </em></font></p><p><font color='#999999' size='1'><em>(2) Voir aussi accord du 11 octobre 1989, article 6. </em></font></p><p><font color='#999999' size='1'><em>(3) Alinéas abrogés par avenant du 9 juillet 1964 (non étendu). </em></font></p><p><font color='#999999' size='1'><em>(4) Paragraphe ajouté avenant du 9 juillet 1964 (non étendu). </em></font></p>",
    num: "18",
    origine: "KALI",
    nature: "Article",
    versionArticle: "2.0",
    etat: "VIGUEUR_ETEN",
    dateDebut: 624067200000,
    dateFin: 32472144000000,
    dateDebutExtension: 32472144000000,
    dateFinExtension: 32472144000000,
    inap: null,
    ordre: 85898,
    context: {
      titresTM: [
        {
          debut: "1952-12-30",
          fin: "2999-01-01",
          titre: "Clauses générales",
          xPath: "/ARTICLE/CONTEXTE/TEXTE/TM/TITRE_TM",
          cid: "KALISCTA000005722130",
          id: "KALISCTA000005722130",
          etat: "VIGUEUR_ETEN",
        },
        {
          debut: "1989-10-11",
          fin: "2999-01-01",
          titre: "Congés payés",
          xPath: "/ARTICLE/CONTEXTE/TEXTE/TM/TM/TITRE_TM",
          cid: "KALISCTA000005751424",
          id: "KALISCTA000005751424",
          etat: "VIGUEUR_ETEN",
        },
      ],
      nombreVersionParent: 1,
      longeurChemin: 38,
      titreTxt: [
        {
          debut: "1952-12-30",
          fin: "2999-01-01",
          titre:
            "Convention collective nationale des industries chimiques et connexes du 30 décembre 1952. Étendue par arrêté du 13 novembre 1956 JONC 12 décembre 1956",
          xPath: "/ARTICLE/CONTEXTE/TEXTE/TITRE_TXT",
          cid: "KALITEXT000005677744",
          id: "KALITEXT000005677744",
          etat: "VIGUEUR_ETEN",
        },
      ],
    },
    cid: "KALIARTI000005846033",
    cidTexte: null,
    sectionParentCid: "KALISCTA000005751424",
    sectionParentId: "KALISCTA000005751424",
    sectionParentTitre: "Congés payés",
    fullSectionsTitre: "Clauses générales &gt; Congés payés",
    refInjection: "IG-20210817",
    idTechInjection: "KALIARTI000005846034",
    idEli: null,
    idEliAlias: null,
    calipsos: [],
    textTitles: [
      {
        id: "KALITEXT000005677744",
        titre: "Convention collective nationale du 30 décembre 1952",
        titreLong:
          "Convention collective nationale des industries chimiques et connexes du 30 décembre 1952. Étendue par arrêté du 13 novembre 1956 JONC 12 décembre 1956",
        etat: "VIGUEUR_ETEN",
        dateDebut: -536630400000,
        dateFin: 32472144000000,
        cid: "KALITEXT000005677744",
        datePubli: 32472144000000,
        datePubliComputed: null,
        dateTexte: -536630400000,
        dateTexteComputed: -536630400000,
        nature: "Convention collective nationale ",
        nor: "",
        num: "",
        numParution: "",
        originePubli: "JORF du 01 janvier 2999",
        appliGeo: "A NATIONAL",
        codesNomenclatures: [
          "05-31",
          "13-01",
          "13-04",
          "17-12",
          "17-13",
          "17-14",
          "17-15",
          "17-16",
          "17-17",
          "17-18",
          "17-19",
          "17-21",
          "17-22",
          "17-23",
          "17-24",
          "17-25",
          "17-26",
          "17-28",
          "17-29",
          "18-01",
          "18-02",
          "18-03",
          "18-05",
          "18-06",
          "18-07",
          "18-08",
          "18-09",
          "18-10",
          "18-11",
          "29-22",
          "39-07",
          "40-11",
          "40-12",
          "44-37",
          "50-03",
          "50-04",
          "52-04",
          "54-06",
          "54-09",
          "56-02",
          "59-04",
          "77-01",
          "77-15",
          "83-01",
          "87-10",
        ],
        visas: null,
        nota: null,
        notice: null,
        travauxPreparatoires: null,
        signataires: null,
        dossiersLegislatifs: [],
        ancienId: null,
      },
    ],
    nota: null,
    notaHtml: null,
    activitePro: ["Industries chimiques et connexes"],
    numeroBrochure: ["3108"],
    numeroBo: null,
    conteneurs: [
      {
        cid: "KALICONT000005635613",
        datePubli: -536630400000,
        etat: "VIGUEUR_ETEN",
        nature: "IDCC",
        num: "44",
        numero: "0000000000000044",
        titre:
          "Convention collective nationale des industries chimiques et connexes du 30 décembre 1952. Étendue par arrêté du 13 novembre 1956 JONC 12 décembre 1956",
      },
    ],
    lienModifications: [
      {
        textCid: "",
        textTitle: "Avenant n° 1964-07-09",
        linkType: "MODIFICATION",
        linkOrientation: "source",
        articleNum: "",
        articleId: "",
        natureText: "",
        datePubliTexte: null,
        dateSignaTexte: null,
        dateDebutCible: null,
      },
      {
        textCid: "",
        textTitle:
          "Convention collective nationale 1952-12-30 étendue par arrêté du 13 novembre 1956 JONC 12 décembre 1956",
        linkType: "CREATION",
        linkOrientation: "source",
        articleNum: "",
        articleId: "",
        natureText: "",
        datePubliTexte: null,
        dateSignaTexte: null,
        dateDebutCible: null,
      },
    ],
    lienCitations: [
      {
        textCid: "",
        textTitle: "Accord 1989-10-11 art. 6",
        linkType: "CITATION",
        linkOrientation: "source",
        articleNum: "",
        articleId: "",
        natureText: "",
        date: 1629206577553,
        parentCid: null,
        numTexte: "",
        datePubli: null,
        dateDebut: null,
      },
    ],
    lienConcordes: [],
    lienAutres: [],
    articleVersions: [
      {
        id: "KALIARTI000005846033",
        etat: "REMPLACE",
        version: "1.0",
        dateDebut: 624067200000,
        dateFin: 624067200000,
        numero: null,
        ordre: null,
      },
      {
        id: "KALIARTI000005846034",
        etat: "VIGUEUR_ETEN",
        version: "2.0",
        dateDebut: 624067200000,
        dateFin: 32472144000000,
        numero: null,
        ordre: null,
      },
    ],
    computedNums: ["18"],
    versionPrecedente: null,
    conditionDiffere: null,
    historique:
      "Modifié par accord du 11 octobre 1989 étendu par arrêté du 25 janvier 1990 JORF 30 janvier 1990.",
    surtitre: null,
    renvoi: null,
  },
};
